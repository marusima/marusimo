<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Star Collector</title>
<style>
body {
    margin: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    background: radial-gradient(circle at center, #000010, #000000);
    font-family: Arial, sans-serif;
    color: white;
    overflow: hidden;
}

/* Blikaj√≠c√≠ hvƒõzdiƒçky na pozad√≠ */
.star {
    position: absolute;
    animation: twinkle 2s infinite;
}

@keyframes twinkle {
    0%,100% {opacity: 0.8;}
    50% {opacity: 0.2;}
}

/* Hern√≠ wrapper */
#game-container-wrapper {
    display: flex;
    flex-direction: column; /* pod sebou */
    align-items: center;    /* vyst≈ôedƒõn√≠ */
    z-index: 5;
    position: relative;
}

/* Hern√≠ pl√°tno */
#game-container {
    position: relative;
}

#game {
    display: grid;
    grid-template-columns: repeat(20, 60px);
    grid-template-rows: repeat(10, 60px);
    gap: 3px;
    background: rgba(0,0,0,0.8);
    padding: 15px;
    border-radius: 12px;
    box-shadow: 0 0 30px rgba(255,255,255,0.2);
    z-index: 1;
}

.cell {
    width: 60px;
    height: 60px;
    background: radial-gradient(circle at center, #0a0a0a 0%, #000010 100%);
    border-radius: 8px;
    display: flex;
    justify-content: center;
    align-items: center;
}

.cell img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 8px;
}

/* Sk√≥re pod polem */
#score {
    font-size: 24px;
    background: rgba(255,255,255,0.1);
    padding: 10px 14px;
    border-radius: 12px;
    margin-top: 20px; /* mezera od hrac√≠ho pole */
    box-shadow: 0 0 15px #fff;
    text-align: center;
}
    
/* Modaly */
.modal {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(20,20,30,0.95);
    padding: 30px 40px;
    border-radius: 16px;
    box-shadow: 0 0 20px #fff;
    text-align: center;
    z-index: 100;
}

.modal h2 {
    font-size: 24px;
    margin-bottom: 15px;
}

.modal input {
    font-size: 20px;
    padding: 6px 10px;
    border-radius: 6px;
    border: none;
    margin-bottom: 10px;
    text-align: center;
    width: 80%;
}

.modal button {
    font-size: 20px;
    padding: 8px 20px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    background: #ffcc00;
    color: #000;
}
</style>
</head>
<body>

<div class="stars" id="stars"></div>

<div id="game-container-wrapper">
    <div id="game-container">
        <div id="game"></div>
    </div>
    <div id="score">‚≠ê 0 - Dobrodru≈æstv√≠ ƒçek√°!</div>
</div>

<!-- Game Over Modal -->
<div class="modal" id="gameover-modal">
    <h2 id="gameover-text"></h2>
    <button onclick="restartGame()">Hr√°t znovu</button>
</div>

<!-- √övodn√≠ Modal -->
<div class="modal" id="intro-modal">
    <h2>V√≠tejte ve vesm√≠ru!</h2>
    <p>Zde m≈Ø≈æete ulovit v≈°echny z√°zraky svƒõta. üåå</p>
    <p>Zvolte si, kolik z√°zrak≈Ø dnes chcete ulovit (1‚Äì15):</p>
    <input type="number" id="target-input" min="1" max="15" value="5">
    <br>
    <button onclick="startGame()">Start!</button>
</div>

<script>
    
// Blikaj√≠c√≠ hvƒõzdiƒçky
const starsContainer = document.getElementById('stars');
for(let i=0;i<150;i++){
    const star = document.createElement('div');
    star.className = 'star';
    star.style.left = Math.random()*window.innerWidth+'px';
    star.style.top = Math.random()*window.innerHeight+'px';
    star.style.width = star.style.height = (Math.random()*2+1)+'px'; // velikost
    star.style.borderRadius = '50%'; // kruh
    star.style.backgroundColor = 'white';
    star.style.animationDuration = (Math.random()*3+1)+'s';
    starsContainer.appendChild(star);
}


// Hra
const gameWidth = 20;
const gameHeight = 10;
const game = document.getElementById("game");
const scoreEl = document.getElementById("score");
const modal = document.getElementById("gameover-modal");
const gameoverText = document.getElementById("gameover-text");
const introModal = document.getElementById("intro-modal");
const targetInput = document.getElementById("target-input");

let player = { x: Math.floor(gameWidth/2), y: Math.floor(gameHeight/2) };
let star = randomPosition();
let holes = [];
let direction = { x:0, y:0 };
let score = 0;
let targetScore = 5; // default
let gameInterval = null;

// √övodn√≠ modal
introModal.style.display = 'block';

function startGame(){
    const val = parseInt(targetInput.value);
    if(val>=1 && val<=15){
        targetScore = val;
        introModal.style.display='none';
        resetGame();
        // Spustit pohyb hr√°ƒçe
        if(!gameInterval) {
            gameInterval = setInterval(movePlayer, 300);
        }
    } else {
        alert("Zadejte ƒç√≠slo od 1 do 15!");
    }
}

// N√°hodn√° pozice
function randomPosition() {
    return { x: Math.floor(Math.random()*gameWidth), y: Math.floor(Math.random()*gameHeight) };
}

// Vygenerov√°n√≠ ƒçern√Ωch dƒõr (4‚Äì8)
function generateHoles() {
    const numHoles = Math.floor(Math.random()*5)+4; // 4‚Äì8
    let arr = [];
    while(arr.length<numHoles){
        let h = randomPosition();
        if(!((h.x===player.x && h.y===player.y) || (h.x===star.x && h.y===star.y)) &&
           !arr.some(e=>e.x===h.x && e.y===h.y)){
            arr.push(h);
        }
    }
    return arr;
}

// Vykreslen√≠ hry
// Vykreslen√≠ hry + koment√°≈ôe ke sk√≥re
function drawGame(){
    game.innerHTML='';
    for(let y=0;y<gameHeight;y++){
        for(let x=0;x<gameWidth;x++){
            const cell = document.createElement('div');
            cell.className='cell';

            if(x===player.x && y===player.y){
                const img=document.createElement('img');
                img.src='../static/player.png';
                img.alt='player';
                cell.appendChild(img);
            } else if(x===star.x && y===star.y){
                const img=document.createElement('img');
                img.src='../static/star.png';
                img.alt='star';
                cell.appendChild(img);
            } else if(holes.some(h=>h.x===x && h.y===y)){
                const img=document.createElement('img');
                img.src='../static/hole.jpg';
                img.alt='hole';
                cell.appendChild(img);
            }

            game.appendChild(cell);
        }
    }

    // V√Ωpoƒçet procent c√≠le
    let percent = Math.floor((score/targetScore)*100);
    let comment = "";
    if(percent === 0) comment = "üõ∏ Startujeme, hodnƒõ ≈°tƒõst√≠!";
    else if(percent < 25) comment = "üåü M√°lo hvƒõzdiƒçek, je≈°tƒõ dlouh√° cesta!";
    else if(percent < 50) comment = "‚ú® Skvƒõl√Ω! U≈æ jsi skoro v polovinƒõ, sb√≠rej d√°l!";
    else if(percent < 75) comment = "üöÄ Pƒõknƒõ se da≈ô√≠, polovina za n√°mi!";
    else if(percent < 90) comment = "üí´ U≈æ c√≠t√≠≈° to ≈°tƒõst√≠? Posledn√≠ √∫sil√≠!";
    else if(percent < 100) comment = "üåå Skoro hotovo, posledn√≠ hvƒõzdiƒçky!";
    else comment = "üéâ C√≠l dosa≈æen, gratulujeme!";

    scoreEl.textContent = `‚≠ê ${score} / ${targetScore} - ${comment}`;
}


// Pohyb hr√°ƒçe
function movePlayer() {
    player.x += direction.x;
    player.y += direction.y;

    // Vyletƒõn√≠ z mapy
    // Kontrola vyletƒõn√≠
    if(player.x<0 || player.x>=gameWidth || player.y<0 || player.y>=gameHeight){
        gameOver("üí´ Vyletƒõli jste hluboko do vesm√≠ru a u≈æ nen√≠ n√°vratu!");
        return;
    }

    // Kolize s ƒçernou d√≠rou
    if(holes.some(h=>h.x===player.x && h.y===player.y)){
        gameOver("‚ö´ Haha! ƒåern√° d√≠ra v√°s pohlt√≠ a u≈æ v√°s neuvid√≠ ani hvƒõzdy!");
        return;
    }

    // Sebran√≠ hvƒõzdy
    if(player.x===star.x && player.y===star.y){
        score++;
        if(score>=targetScore){
            gameOver("üéâ Gratulujeme! Ulovili jste si sv√© dne≈°n√≠ ≈°tƒõst√≠ a v≈°echny z√°zraky vesm√≠ru! üåü");
            return;
        }
        star=randomPosition();
        holes=generateHoles();
    }

    drawGame();
}

// Konec hry
function gameOver(msg){
    modal.style.display='block';
    gameoverText.textContent=msg;
    direction={x:0,y:0};
}

// Restart hry
function restartGame(){
    modal.style.display='none';
    score=0;
    resetGame();
}

// Reset hry
function resetGame(){
    player={x: Math.floor(gameWidth/2), y: Math.floor(gameHeight/2)};
    star=randomPosition();
    holes=generateHoles();
    direction={x:0, y:0};
    drawGame();
}

// Ovl√°d√°n√≠ ≈°ipkami
document.addEventListener('keydown', e=>{
    if(e.key==='ArrowUp') direction={x:0,y:-1};
    if(e.key==='ArrowDown') direction={x:0,y:1};
    if(e.key==='ArrowLeft') direction={x:-1,y:0};
    if(e.key==='ArrowRight') direction={x:1,y:0};
});
</script>

</body>
</html>
